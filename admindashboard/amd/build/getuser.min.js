/**
 * Add a create new group modal to the page.
 *
 * @module     block_admindashboard/register
 * @class      register
 * @package    block_admindashboard
 * @copyright  2017 Shivani
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */ define(["local_rolemanagement/cardPaginate","jquery","core/str","core/modal_factory","core/modal_events","core/fragment","core/templates","core/ajax","core/yui"],function(e,t,a,s,o,n,r,i,d){var c=function(e){this.userid=e.userid,this.courseid=e.courseid,this.type=e.type,this.init(e)};return c.prototype.modal=null,c.prototype.contextid=-1,c.prototype.init=function(e){var o=this;return a.get_string("users","block_admindashboard").then((function(e){return s.create({type:s.types.DEFAULT,title:e,body:o.getBody(),footer:this.getFooter()})}).bind(o)).then((function(e){return o.modal=e,o.modal.setLarge(),this.modal.getFooter().find('[data-action="cancel"]').on("click",function(){e.destroy()}),this.modal.getFooter().find('[data-action="skip"]').on("click",function(){o.args.form_status=o.args.form_status+1;var t=o.getBody();e.setBody(t)}),this.modal.show(),this.modal.getRoot().animate({right:"0%"},500),t(".close").click(function(){e.destroy()}),this.modal}).bind(this))},c.prototype.getBody=function(){return(params={}).userid=this.userid,params.courseid=this.courseid,params.type=this.type,n.loadFragment("block_admindashboard","user_details",5,params)},c.prototype.getFooter=function(){return'<button type="button" class="btn btn-secondary" data-action="cancel">Cancel</button>'},{init:function(e){return new c(e)},search:function(a){var s=t("#userssearch").val(),o={};o.targetID="manage_userdetails",o.perPage=5,o.cardClass="w_one",o.viewType="card",o.methodName="block_admin_manage_userdetails",o.templateName="block_admindashboard/usersdisplay";var n={};n.userid=1,n.contextid=1,n.courseid=a.courseid,n.type=a.courseid,n.search=s;var r={},i={};i.targetID="manage_userdetails",i.options=JSON.stringify(o),i.dataoptions=JSON.stringify(n),i.filterdata=JSON.stringify(r),e.reload(o,n,r)},load:function(){},suspendConfirm:function(n){return a.get_strings([{key:"confirm"},{key:"suspendconfirm",component:"block_admindashboard",param:n},{key:"deleteallconfirm",component:"block_admindashboard"},{key:"suspend",component:"block_admindashboard"}]).then((function(a){s.create({title:a[0],type:s.types.DELETE_CANCEL,body:a[1]}).done((function(s){this.modal=s,s.setDeleteButtonText(a[3]),s.getRoot().on(o.delete,(function(a){a.preventDefault(),n.confirm=!0;var o={};o.id=n.id,o.contextid=n.contextid,"suspend"==n.selector?o.type="suspend":o.type="unsuspend",i.call([{methodname:"block_admindashboard_suspend_user",args:o}])[0].done(function(a){t(".error").html("<div class='alert alert-success'> Changes Saved successfully.</div>"),setInterval(function(){t(".alert").fadeOut()},5e3);var o=t("select#id_status").val(),n=t("select#id_roles").val(),r=t("select#id_type").val(),i=t("#id_userssearch").val(),d={};d.targetID="manage_usermanagementusers",d.perPage=10,d.cardClass="w_one",d.viewType="card",d.methodName="block_admindashboard_users_list",d.templateName="block_admindashboard/users";var c={};c.userid=1,c.contextid=1,c.selected_status=o,c.selected_roles=n,c.selected_type=r,c.search=i;var l={},u={};u.targetID="manage_usermanagementusers",u.options=JSON.stringify(d),u.dataoptions=JSON.stringify(c),u.filterdata=JSON.stringify(l),t("#studentsearch").css("visibility","visible"),e.reload(d,c,l),s.destroy(),s.hide()}).fail(function(e){})}).bind(this)),s.show()}).bind(this))}).bind(this))}}});