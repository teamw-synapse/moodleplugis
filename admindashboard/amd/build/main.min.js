define(["local_rolemanagement/cardPaginate","jquery","core/ajax","core/templates"],function(e,t,a,s){return{search:function(a){var s=t("select#id_status").val(),r=t("select#id_roles").val(),i=t("select#id_type").val(),l=t("#studentsearch").val();if(""!=s&&""!=r){var n={};n.targetID="manage_usermanagementusers",n.perPage=10,n.cardClass="w_one",n.viewType="card",n.methodName="block_admindashboard_users_list",n.templateName="block_admindashboard/users";var o={};o.userid=1,o.contextid=1,o.selected_status=s,o.selected_roles=r,o.selected_type=i,o.search=l;var c={},d={};d.targetID="manage_usermanagementusers",d.options=JSON.stringify(n),d.dataoptions=JSON.stringify(o),d.filterdata=JSON.stringify(c),e.reload(n,o,c)}else t(".manage_usermanagementusers").html("<div class='alert alert-warning'><strong>Warning!</strong> Please Select Status and Role</div>"),setInterval(function(){t(".alert").fadeOut()},3e4)},coursesearch:function(a){var s=t("select#id_coursestatus").val(),r=t("select#id_sub_categories").val(),i=t("select#id_child_categories").val(),l=t("select#id_all_courses").val(),n=t("#coursesearch").val(),o={};o.targetID="manage_usermanagementcourse",o.perPage=3,o.cardClass="w_one",o.viewType="card",o.methodName="report_courses",o.templateName="block_admindashboard/courses";var c={};c.userid=1,c.contextid=1,c.maincategoryid=s,c.catagory=r,c.subcatagory=i,c.unitid=l?l.join():0,c.search=n;var d={},u={};u.targetID="manage_usermanagementcourse",u.options=JSON.stringify(o),u.dataoptions=JSON.stringify(c),u.filterdata=JSON.stringify(d),t("#coursesearch").css("visibility","visible"),e.reload(o,c,d)},load:function(){t(document).ready(function(){t("#id_submitbtn").on("click",function(){var a=t("select#id_status").val(),s=t("select#id_roles").val(),r=t("select#id_type").val(),i=t("#id_userssearch").val();if(""!=a&&""!=s&&""!=r){t("#studentsearch").css("visibility","visible"),t("#manage_usermanagementusers").css("visibility","visible");var l={};l.targetID="manage_usermanagementusers",l.perPage=10,l.cardClass="w_one",l.viewType="card",l.methodName="block_admindashboard_users_list",l.templateName="block_admindashboard/users";var n={};n.userid=1,n.contextid=1,n.selected_status=a,n.selected_roles=s,n.selected_type=r,n.search=i;var o={},c={};c.targetID="manage_usermanagementusers",c.options=JSON.stringify(l),c.dataoptions=JSON.stringify(n),c.filterdata=JSON.stringify(o),t("#studentsearch").css("visibility","visible"),e.reload(l,n,o)}else t(".error").html("<div class='alert alert-warning'><strong>Warning!</strong> Please Select Status and Role</div>"),setInterval(function(){t(".alert").fadeOut()},3e3)}),t("#id_applybtn").on("click",function(){var a=t("select#id_coursestatus").val(),s=t("select#id_sub_categories").val(),r=t("select#id_child_categories").val(),i=t("select#id_all_courses").val();if(a&&s){t("#coursesearch").css("visibility","visible"),t("#manage_usermanagementcourse").css("visibility","visible");var l={};l.targetID="manage_usermanagementcourse",l.perPage=2,l.cardClass="w_one",l.viewType="card",l.methodName="report_courses",l.templateName="block_admindashboard/courses";var n={};n.userid=1,n.contextid=1,n.maincategoryid=a,n.catagory=s,n.subcatagory=r,n.unitid=i?i.join():0;var o={},c={};c.targetID="manage_usermanagementcourse",c.options=JSON.stringify(l),c.dataoptions=JSON.stringify(n),c.filterdata=JSON.stringify(o),t("#coursesearch").css("visibility","visible"),e.reload(l,n,o)}else t(".resultsetdata").html("<div class='alert alert-warning'><strong>Warning!</strong> Please Select Course and Sub Course</div>"),setInterval(function(){t(".alert").fadeOut()},3e4)}),t("#id_enrollbtn").on("click",function(e){var s=t("select#id_enrollcourse").val();console.log(s);var r=t("select#id_enrollgroup").val();console.log(r);var i=t("select#id_enrolluser").val();console.log(i);var l=t("select#id_assignrole").val();(console.log(l),s&&r&&i&&l)?a.call([{methodname:"admin_user_enrollment",args:{courseid:s||0,userid:i?i.join(","):0,groupid:r?r.join(","):0,roleid:l}}])[0].done(function(a){console.log(a),a.users.length>0?(t(".enrollresultsetdata").html(),t.each(a.users,function(a,s){200==s.status?(e.preventDefault(),t("#fitem_id_assignrole .form-autocomplete-selection").children().remove(),t("#fitem_id_enrolluser .form-autocomplete-selection").children().remove(),t("#fitem_id_enrollcourse .form-autocomplete-selection").children().remove(),t("#fitem_id_enrollgroup .form-autocomplete-selection").children().remove(),t(".enrollresultsetdata").append("<div class='alert alert-success'><strong>Success!</strong> <strong>"+s.studentname+"</strong> has been enrolled to <strong>"+s.unitname+"</strong> with  <strong>"+s.roles+"</strong> roles. <button type='button' class='close' data-dismiss='alert' aria-label='Close'><span aria-hidden='true'>&times;</span>  </button></div>"),setInterval(function(){t(".alert").fadeOut()},3e4)):400==s.status&&(e.preventDefault(),t("#fitem_id_assignrole .form-autocomplete-selection").children().remove(),t("#fitem_id_enrolluser .form-autocomplete-selection").children().remove(),t("#fitem_id_enrollcourse .form-autocomplete-selection").children().remove(),t("#fitem_id_enrollgroup .form-autocomplete-selection").children().remove(),t(".enrollresultsetdata").append("<div class='alert alert-danger'><strong>Error!</strong> <strong>"+s.studentname+"</strong> has been already enrolled to <strong>"+s.unitname+"</strong> <button type='button' class='close' data-dismiss='alert' aria-label='Close'><span aria-hidden='true'>&times;</span>  </button></div>"),setInterval(function(){t(".alert").fadeOut()},3e4))})):(t(".enrollresultsetdata").html("<div class='alert alert-warning'><strong>Warning!</strong> "+a.methodstatus+" <button type='button' class='close' data-dismiss='alert' aria-label='Close'><span aria-hidden='true'>&times;</span>  </button></div>"),setInterval(function(){t(".alert").fadeOut()},3e4))}).fail(function(e){}):t(".enrollresultsetdata").html("Fail")})})}}});