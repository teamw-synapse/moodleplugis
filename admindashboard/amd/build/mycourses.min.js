define(["local_rolemanagement/cardPaginate","jquery","core/ajax","core/templates"],function(e,o,n,r){return{load:function(){o(document).ready(function(){o("#id_coursestatus").on("change",function(){var e,r,t,e=o("#id_coursestatus").val(),r=0,t=0;n.call([{methodname:"report_category",args:{id:e,subid:r,unitid:t}}])[0].done(function(e){var n,r="";for(i=0,r=" <option value='0'>Select Course Name</option>";i<e.category.length;i++){r+="<option value='"+e.category[i].categoryid+"'>"+e.category[i].categoryname+"</option>"}o("#id_sub_categories").children().remove().end().append(r)}).fail(function(e){})}),o("#id_enrollcourse").on("change",function(){var e=o("#id_enrollcourse").val();e>0?o("#id_add-course-btn").css("display","block"):o("#id_add-course-btn").css("display","none"),n.call([{methodname:"report_category",args:{id:0,subid:0,unitid:e||0}}])[0].done(function(e){var n,r;for(i=0,subselOpts=" <option value='0'>Select Group Name</option>";i<e.groups.length;i++){subselOpts+="<option value='"+e.groups[i].groupid+"'>"+e.groups[i].groupname+"</option>"}for(o("#id_enrollgroup").children().remove().end().append(subselOpts),roleselOpts=" <option value='0'>Select Assign Role</option>",i=0;i<e.roles.length;i++){roleselOpts+="<option value='"+e.roles[i].roleid+"'>"+e.roles[i].rolename+"</option>"}}).fail(function(e){})}),o("#id_sub_categories").on("change",function(){var e,r,t,e=o("#id_coursestatus").val(),r=o("#id_sub_categories").val(),t=0;n.call([{methodname:"report_category",args:{id:e,subid:r,unitid:t}}])[0].done(function(e){for(i=0,subselOpts=" <option value='0'>Select Unit Name</option>";i<e.ccategory.length;i++){var n;subselOpts+="<option value='"+e.ccategory[i].categoryid+"'>"+e.ccategory[i].categoryname+"</option>"}o("#id_child_categories").children().remove().end().append(subselOpts)}).fail(function(e){})}),o("#id_child_categories").on("change",function(){var e=o("#id_child_categories").val();n.call([{methodname:"get_courselist",args:{categoryid:e}}])[0].done(function(e){var n,r="";for(i=0,r=" <option value='0'>Select Course Name</option>";i<e.course.length;i++){r+="<option value='"+e.course[i].courseid+"'>"+e.course[i].courseshortname+"</option>"}o("#id_all_courses").children().remove().end().append(r)}).fail(function(e){})}),o("#fitem_id_enrollcourse").on("keyup",function(){var e=o("#fitem_id_enrollcourse").find(".form-control").first().val();e.length>3&&n.call([{methodname:"report_searchcourses",args:{search:e}}])[0].done(function(e){for(i=0,subselOpts=" <option value='0'>Select Unit Name</option>",selopt="";i<e.courses.length;i++){var n=e.courses[i].courseid,r=e.courses[i].coursename;selopt+='<li role="option" data-value="'+n+'" aria-selected="false" >'+r+"</li>",subselOpts+="<option value='"+n+"'>"+r+"</option>"}o("#id_enrollcourse").children().remove().end().append(subselOpts),o("#fitem_id_enrollcourse .form-autocomplete-suggestions").children().remove().end().append(selopt),o("#fitem_id_enrollcourse .form-autocomplete-suggestions").css("display","block")}).fail(function(e){})}),o("#fitem_id_enrolluser").on("keyup",function(){var e=o("#fitem_id_enrolluser").find(".form-control").first().val();e.length>3&&n.call([{methodname:"report_searchusers",args:{search:e}}])[0].done(function(e){for(i=0,studentselOpts=" <option value='0'>Select Student Name</option>",selopt="";i<e.users.length;i++){var n=e.users[i].studentid,r=e.users[i].studentname,t=e.users[i].studentidnumber;selopt+='<li role="option" data-value="'+n+'" aria-selected="false" >'+r+"("+t+")</li>",studentselOpts+="<option value='"+n+"'>"+r+"("+t+")</option>"}o("#id_enrolluser").children().remove().end().append(studentselOpts),o("#fitem_id_enrolluser .form-autocomplete-suggestions").children().remove().end().append(selopt),o("#fitem_id_enrolluser .form-autocomplete-suggestions").css("display","block")}).fail(function(e){})}),o("#fitem_id_unenrollcourse").on("keyup",function(){var e=o("#fitem_id_unenrollcourse").find(".form-control").first().val();e.length>3&&n.call([{methodname:"report_searchcourses",args:{search:e}}])[0].done(function(e){for(i=0,subselOpts=" <option value='0'>Select Unit Name</option>",selopt="";i<e.courses.length;i++){var n=e.courses[i].courseid,r=e.courses[i].coursename;selopt+='<li role="option" data-value="'+n+'" aria-selected="false" >'+r+"</li>",subselOpts+="<option value='"+n+"'>"+r+"</option>"}o("#id_unenrollcourse").children().remove().end().append(subselOpts),o("#fitem_id_unenrollcourse .form-autocomplete-suggestions").children().remove().end().append(selopt),o("#fitem_id_unenrollcourse .form-autocomplete-suggestions").css("display","block")}).fail(function(e){})}),o("#id_unenrollcourse").on("change",function(){var e=o("#id_unenrollcourse").val();n.call([{methodname:"get_courseusers",args:{courseid:e}}])[0].done(function(e){var n="";for(i=0,n=" <option value='0'>Select User Name</option>";i<e.users.length;i++){var r,t=e.users[i].userid;n+="<option value='"+t+"'>"+e.users[i].username+"("+e.users[i].useremail+")</option>"}o("#id_unenrolluser").children().remove().end().append(n)}).fail(function(e){})}),o("#id_unenrollbtn").on("click",function(){var e=o("#id_unenrollcourse").val(),r=o("#id_unenrolluser").val();n.call([{methodname:"admin_user_unenrollment",args:{userid:r,courseid:e}}])[0].done(function(e){200==e.status?(o("#fitem_id_unenrolluser .form-autocomplete-selection").children().remove(),o("#fitem_id_unenrollcourse .form-autocomplete-selection").children().remove(),o(".unenrollresultsetdata").append("<div class='alert alert-success'><strong>Success!</strong> <strong>"+e.username+"</strong> has been unenrolled to <strong>"+e.unitname+"</strong> <button type='button' class='close' data-dismiss='alert' aria-label='Close'><span aria-hidden='true'>&times;</span>  </button></div>"),setInterval(function(){o(".alert").fadeOut()},3e4)):(o("#fitem_id_unenrolluser .form-autocomplete-selection").children().remove(),o("#fitem_id_unenrollcourse .form-autocomplete-selection").children().remove(),o(".unenrollresultsetdata").append("<div class='alert alert-danger'><strong>Error!</strong> <strong>"+e.username+"</strong> has been already unenrolled to <strong>"+e.unitname+"</strong> <button type='button' class='close' data-dismiss='alert' aria-label='Close'><span aria-hidden='true'>&times;</span>  </button></div>"),setInterval(function(){o(".alert").fadeOut()},3e4))}).fail(function(e){})}),o("#id_unrollcancelbtn").on("click",function(){o("#fitem_id_unenrolluser .form-autocomplete-selection").children().remove(),o("#fitem_id_unenrollcourse .form-autocomplete-selection").children().remove()}),o("#id_enrollcancelbtn").on("click",function(){o("#fitem_id_assignrole .form-autocomplete-selection").children().remove(),o("#fitem_id_enrolluser .form-autocomplete-selection").children().remove(),o("#fitem_id_enrollcourse .form-autocomplete-selection").children().remove(),o("#fitem_id_enrollgroup .form-autocomplete-selection").children().remove()}),o("#id_applycancelbtn").on("click",function(){o("#coursesearch").css("visibility","hidden"),o("#manage_usermanagementcourse").css("visibility","hidden"),o("#fitem_id_coursestatus .form-autocomplete-selection").children().remove(),o("#fitem_id_sub_categories .form-autocomplete-selection").children().remove(),o("#fitem_id_child_categories .form-autocomplete-selection").children().remove(),o("#fitem_id_all_courses .form-autocomplete-selection").children().remove(),o("#id_child_categories").children().remove(),o("#id_sub_categories").children().remove(),o("#id_all_courses").children().remove(),o("select#id_coursestatus").val(""),o("select#id_sub_categories").val(""),o("select#id_child_categories").val(""),o("select#id_all_courses").val("")}),o("#id_submitcancelbtn").on("click",function(){o("#studentsearch").css("visibility","hidden"),o("#manage_usermanagementusers").css("visibility","hidden"),o("#fitem_id_status .form-autocomplete-selection").children().remove(),o("#fitem_id_type .form-autocomplete-selection").children().remove(),o("#fitem_id_roles .form-autocomplete-selection").children().remove(),o("select#id_status").val(""),o("select#id_roles").val(""),o("select#id_type").val("")})})},search:function(){alert()}}});